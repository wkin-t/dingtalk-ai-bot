# OpenClaw 钉钉机器人环境变量配置示例
# 复制此文件为 .env.openclaw 并填入真实值

# === 钉钉机器人凭证 (新建一个独立的钉钉应用) ===
DINGTALK_CLIENT_ID=your_openclaw_client_id
DINGTALK_CLIENT_SECRET=your_openclaw_client_secret
DINGTALK_CORP_ID=your_corp_id
DINGTALK_COOL_APP_CODE=your_cool_app_code

# === 钉钉 API 抗抖动配置（可选） ===
# 建议在国内网络环境开启直连，规避代理链路导致的 TLS EOF 抖动
DINGTALK_FORCE_DIRECT=true
DINGTALK_RETRY_ATTEMPTS=5
DINGTALK_RETRY_BASE_DELAY=0.8
DINGTALK_RETRY_MAX_DELAY=8.0
DINGTALK_RETRY_JITTER=0.35
DINGTALK_CONNECT_TIMEOUT_MS=15000
DINGTALK_READ_TIMEOUT_MS=60000
DINGTALK_RUNTIME_MAX_ATTEMPTS=2
DINGTALK_FILE_DOWNLOAD_TIMEOUT=30
DINGTALK_TOKEN_EARLY_REFRESH_SEC=120

# === OpenClaw Gateway 配置 ===
# WebSocket 地址 (使用 host 网络模式,直接访问宿主机)
OPENCLAW_GATEWAY_URL=ws://127.0.0.1:18789

# Gateway 认证 Token (如果需要)
OPENCLAW_GATEWAY_TOKEN=your_gateway_token

# Agent ID (默认代理 ID，严格模式下未映射群时不使用此值)
OPENCLAW_AGENT_ID=main
OPENCLAW_CONTEXT_MESSAGES=6

# === OpenClaw 多群路由配置 (新) ===
# 钉钉群 conversationId → OpenClaw agent 的映射表
# 格式: JSON 对象，例如: {"cid_xxx":"group-1","cid_yyy":"group-2"}
# 获取 conversation_id: @机器人发消息，从日志中查看 conversation_id 字段
OPENCLAW_GROUP_AGENT_MAPPING={}

# === 严格路由模式（安全特性） ===
# 默认 true: 未在映射表中的群会被拒绝，返回清晰的错误提示
#           这避免了未配置群误打到默认 agent 导致的隐私/隔离风险
# 设为 false: 回退到 OPENCLAW_AGENT_ID（不推荐，可能有隐私风险）
OPENCLAW_STRICT_GROUP_ROUTING=true

# === AI 后端选择 ===
AI_BACKEND=openclaw

# === 钉钉 AI 卡片模板 ID (可复用 Gemini 的模板) ===
CARD_TEMPLATE_ID=ea2d035e-20fe-447d-9fbf-c04658772b24.schema

# === 上下文配置 ===
MAX_HISTORY_LENGTH=50
MAX_STORAGE_LENGTH=1000
